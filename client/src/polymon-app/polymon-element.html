<script>
  (() => {
    /** @polymerBehavior */
    var PolymonElement = {
      properties: {
        user: {
          type: Object
        },

        route: {
          type: Object,
          notify: true
        },

        active: {
          type: Boolean,
          value: false
        }
      },

      observers: ['invalidateClassname(isAttached, active)'],

      created: function() {
        this.__rafs = {};
      },

      deraf: function(name, fn) {
        if (this.__rafs[name]) {
          return;
        }

        this.__rafs[name] = requestAnimationFrame(() => {
          this.__rafs[name] = null;
          fn();
        });
      },

      invalidateClassname: function() {
        if (!this.__resolved) {
          this.removeAttribute('unresolved');
          this.__resolved = true;
        }

        if (this.active && this.isAttached && this._readied) {
          this.deraf('invalidate-classname', () => {
            this.classList.add('active', this.is);
          });
        } else {
          this.classList.remove('active');
        }
      },

      or: function() {
        for (let i = 0; i < arguments.length; ++i) {
          if (arguments[i]) {
            return true;
          }
        }

        return false;
      }
    };

    window.PolymonElement = PolymonElement;
  })();
</script>
